kutugu

medium

# Spot dex should check the balance difference before and after the transfer

## Summary

Spot dex supports transfer-on-fee tokens, should check the balance difference before and after the transfer.

## Vulnerability Detail

The transfer-on-fee tokens charge when the token is transferred, the protocol fails to receive the expected amount.

## Impact

The amount of the protocol received is smaller than expected, resulting in a loss of funds.

## Code Snippet

- https://github.com/sherlock-audit/2023-06-unstoppable/blob/94a68e49971bc6942c75da76720f7170d46c0150/unstoppable-dex-audit/contracts/spot-dex/Dca.vy#L201
- https://github.com/sherlock-audit/2023-06-unstoppable/blob/94a68e49971bc6942c75da76720f7170d46c0150/unstoppable-dex-audit/contracts/spot-dex/LimitOrders.vy#L161

## Tool used

Manual Review

## Recommendation

check the balance difference before and after the transfer
